# Domain 9: Vulnerability Management

## Task 9.1: Vulnerability Lifecycle ⭐⭐

### Vulnerability States

| State | Description | Action |
|-------|-------------|--------|
| **Detected** | Found by scanner | Review |
| **Confirmed** | Verified as real | Prioritize |
| **Dismissed** | False positive | Document reason |
| **Resolved** | Fixed | Verify fix |

### Vulnerability Workflow

```yaml
# 1. Detection
Scanner finds vulnerability → Detected

# 2. Triage
Security team reviews → Confirmed or Dismissed

# 3. Assignment
Assign to developer → In Progress

# 4. Remediation
Developer fixes → Resolved

# 5. Verification
Security verifies → Closed
```

---

## Task 9.2: Vulnerability Dashboard ⭐⭐

### Security Dashboard Views

```yaml
# Project Dashboard
# Project > Security & Compliance > Vulnerability Report
- All vulnerabilities in project
- Filter by severity, scanner, status
- Trend over time
- Export to CSV

# Group Dashboard
# Group > Security & Compliance > Vulnerability Report
- Vulnerabilities across all projects
- Group-level trends
- Top vulnerable projects
- Scanner coverage

# Merge Request Widget
# Shows in MR:
- New vulnerabilities introduced
- Existing vulnerabilities
- Resolved vulnerabilities
- Severity breakdown
```

---

## Task 9.3: Vulnerability Prioritization ⭐⭐

### Priority Matrix

| Severity | Exploitability | Priority | SLA |
|----------|---------------|----------|-----|
| Critical | High | P0 | 24 hours |
| Critical | Medium | P1 | 3 days |
| High | High | P1 | 3 days |
| High | Medium | P2 | 1 week |
| Medium | High | P2 | 1 week |
| Medium | Medium | P3 | 2 weeks |
| Low | Any | P4 | 1 month |

### CVSS Score Consideration

```yaml
# CVSS v3.1 Score Ranges:
Critical: 9.0-10.0
High: 7.0-8.9
Medium: 4.0-6.9
Low: 0.1-3.9

# Additional factors:
- Exploitability
- Attack complexity
- Privileges required
- User interaction
- Impact (CIA)
- Public exploit available
- Asset criticality
```

---

## Task 9.4: Vulnerability Remediation ⭐⭐

### Remediation Strategies

```yaml
# 1. Update/Patch
# Most common solution
- Update dependency to fixed version
- Apply security patch
- Rebuild and redeploy

# 2. Configuration Change
# Mitigate through configuration
- Disable vulnerable feature
- Change security settings
- Apply workaround

# 3. Compensating Controls
# Add additional security layers
- WAF rules
- Network segmentation
- Access controls
- Monitoring/alerting

# 4. Accept Risk
# Document and approve
- Low severity
- Difficult to exploit
- Compensating controls in place
- Planned for future fix

# 5. Remove/Replace
# Eliminate vulnerability source
- Remove vulnerable dependency
- Replace with alternative
- Refactor code
```

### Remediation Example

```yaml
# Vulnerability:
CVE: CVE-2021-44228 (Log4Shell)
Package: log4j-core
Version: 2.14.0
Severity: Critical
CVSS: 10.0

# Remediation:
1. Immediate: Update to 2.17.1
   pom.xml:
   <dependency>
     <groupId>org.apache.logging.log4j</groupId>
     <artifactId>log4j-core</artifactId>
     <version>2.17.1</version>
   </dependency>

2. Test: Run full test suite
3. Deploy: Emergency deployment
4. Verify: Rescan with container scanning
5. Monitor: Check for exploitation attempts
```

---

## Task 9.5: Vulnerability Status Management ⭐⭐

### Change Vulnerability Status

```yaml
# In GitLab UI:
# Security & Compliance > Vulnerability Report
# Click vulnerability > Change status

# Status options:
- Detected (default)
- Confirmed
- Dismissed
- Resolved

# Dismiss reasons:
- False positive
- Used in tests only
- Protected by other controls
- Risk accepted
- Not applicable
```

### Bulk Actions

```yaml
# Select multiple vulnerabilities
# Actions:
- Change status
- Assign to user
- Create issues
- Export
- Dismiss
```

---

## Task 9.6: Create Issues from Vulnerabilities ⭐

### Auto-Create Issues

```yaml
# From vulnerability:
# Click "Create issue"

# Issue contains:
Title: [Security] CVE-2021-44228 in log4j-core
Description:
  - Vulnerability details
  - Severity and CVSS score
  - Affected file/package
  - Remediation steps
  - Links to CVE database
Labels:
  - security
  - vulnerability
  - critical
Assignee: @security-team
```

### Issue Template

```markdown
## Vulnerability Details
- **CVE**: CVE-2021-44228
- **Package**: log4j-core
- **Version**: 2.14.0
- **Severity**: Critical (10.0)
- **Scanner**: Dependency Scanning

## Description
Remote code execution vulnerability in Log4j...

## Remediation
Update to version 2.17.1 or later

## References
- https://nvd.nist.gov/vuln/detail/CVE-2021-44228
- https://logging.apache.org/log4j/2.x/security.html

## Checklist
- [ ] Update dependency
- [ ] Run tests
- [ ] Deploy fix
- [ ] Verify with rescan
- [ ] Update documentation
```

---

## Task 9.7: Vulnerability Trends ⭐

### Track Trends

```yaml
# Metrics to track:
- Total vulnerabilities over time
- New vulnerabilities per week
- Resolved vulnerabilities per week
- Mean time to remediate (MTTR)
- Vulnerability backlog
- Vulnerabilities by severity
- Vulnerabilities by scanner
- Top vulnerable projects

# View in:
# Group > Security & Compliance > Security Dashboard
# - Vulnerability trends chart
# - Project comparison
# - Scanner coverage
```

---

## Task 9.8: False Positive Management ⭐

### Handle False Positives

```yaml
# 1. Verify it's false positive
- Review code context
- Check scanner documentation
- Test exploit scenario
- Consult security team

# 2. Dismiss with reason
Status: Dismissed
Reason: False positive
Comment: "This is test code, not production"

# 3. Configure scanner
# Exclude from future scans
# Update scanner rules
# Add to allowlist

# 4. Report to scanner
# Help improve scanner accuracy
# Submit false positive report
```

---

## Task 9.9: Vulnerability SLA ⭐

### Service Level Agreements

```yaml
# Critical (CVSS 9.0-10.0)
Detection to Fix: 24 hours
Verification: 4 hours
Total: 28 hours

# High (CVSS 7.0-8.9)
Detection to Fix: 3 days
Verification: 1 day
Total: 4 days

# Medium (CVSS 4.0-6.9)
Detection to Fix: 2 weeks
Verification: 3 days
Total: 17 days

# Low (CVSS 0.1-3.9)
Detection to Fix: 1 month
Verification: 1 week
Total: 5 weeks
```

---

## Task 9.10: Vulnerability Reporting ⭐

### Generate Reports

```yaml
# Export vulnerability report:
# Security & Compliance > Vulnerability Report
# Click "Export" > CSV

# Report includes:
- Vulnerability ID
- Title
- Severity
- Status
- Scanner
- Location
- Detected date
- Resolved date
- Assignee

# Use for:
- Executive reporting
- Compliance audits
- Trend analysis
- Team metrics
```

---

## Exam Tips for Domain 9

1. **States** - Detected, Confirmed, Dismissed, Resolved
2. **Dashboard** - Project, Group, MR widget views
3. **Prioritization** - Severity + exploitability
4. **Remediation** - Update, configure, control, accept, remove
5. **Status Management** - Change status, dismiss reasons
6. **Issues** - Create from vulnerabilities
7. **Trends** - Track over time, MTTR
8. **False Positives** - Verify, dismiss, configure
9. **SLA** - Critical 24h, High 3d, Medium 2w, Low 1m
10. **Reporting** - Export CSV, compliance reports

---

## Quick Reference

### Vulnerability States

```yaml
Detected → Confirmed → Resolved
         ↓
      Dismissed (false positive)
```

### Priority Guide

```yaml
P0 (24h): Critical + High exploitability
P1 (3d): Critical/High + Medium exploitability
P2 (1w): Medium + High exploitability
P3 (2w): Medium + Medium exploitability
P4 (1m): Low severity
```

### Remediation Steps

```yaml
1. Identify vulnerability
2. Assess severity and impact
3. Prioritize based on risk
4. Develop fix
5. Test thoroughly
6. Deploy fix
7. Verify with rescan
8. Update status to Resolved
9. Document lessons learned
```
